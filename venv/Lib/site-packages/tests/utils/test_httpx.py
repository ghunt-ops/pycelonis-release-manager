import pytest
from pycelonis_core.utils.errors import PyCelonisValueError
from pycelonis_core.utils.httpx import RetryTransport


class TestRetryTransport:
    def test_too_many_retries_raises_value_error(self):
        with pytest.raises(PyCelonisValueError):
            RetryTransport(retries=11)

    def test_too_low_delay_raises_value_error(self):
        with pytest.raises(PyCelonisValueError):
            RetryTransport(delay=0.9)
