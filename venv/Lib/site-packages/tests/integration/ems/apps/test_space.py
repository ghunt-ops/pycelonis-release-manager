import pytest
from pycelonis.ems.apps import PublishedSpace


@pytest.mark.vcr()
@pytest.mark.xdist_group(name="studio")
class TestPublishedSpace:
    def test_get_space(self, pycelonis_celonis, pycelonis_space):
        # Test space exists within studio
        published_space = pycelonis_celonis.apps.get_space(pycelonis_space.id)
        assert published_space.id == pycelonis_space.id
        assert isinstance(published_space, PublishedSpace)

        spaces = pycelonis_celonis.apps.get_spaces()
        assert pycelonis_space.id in [space.id for space in spaces]
        assert all(isinstance(s, PublishedSpace) for s in spaces)

        # Test space representation
        representation = repr(pycelonis_space)
        for attribute in pycelonis_space.__main_attributes__():
            assert attribute in representation
