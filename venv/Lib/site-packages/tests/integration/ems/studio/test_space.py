import pytest


@pytest.mark.vcr()
@pytest.mark.xdist_group(name="studio")
class TestSpace:
    def test_create_space(self, pycelonis_celonis, pycelonis_space):
        # Test space exists within studio
        assert pycelonis_celonis.studio.get_space(pycelonis_space.id).id == pycelonis_space.id
        assert pycelonis_space.id in [s.id for s in pycelonis_celonis.studio.get_spaces()]

        # Test sync space
        original_name = pycelonis_space.name
        pycelonis_space.name = pycelonis_space.name + "_UPDATED"
        pycelonis_space.sync()
        assert pycelonis_space.name == original_name

        # Test update space
        new_name = pycelonis_space.name + "_UPDATED"
        pycelonis_space.name = new_name
        pycelonis_space.update()
        assert pycelonis_space.name == new_name

        # Test space representation
        representation = repr(pycelonis_space)
        for attribute in pycelonis_space.__main_attributes__():
            assert attribute in representation
