from pycelonis.ems.data_integration.data_model_table_column import DataModelTableColumn
from pycelonis.service.integration.service import PoolColumn, PoolColumnType


class TestDataModelTableColumn:
    def test_data_model_table_column_from_transport_has_same_values_as_transport(
        self, mock_client, example_data_model, example_data_model_table
    ):
        column = PoolColumn(name="TEST", length=20, type_=PoolColumnType.INTEGER)
        data_model_column = DataModelTableColumn.from_transport(
            mock_client,
            example_data_model.data_pool_id,
            example_data_model.id,
            example_data_model_table.name,
            example_data_model_table.alias,
            column,
        )

        assert isinstance(data_model_column, DataModelTableColumn)
        assert data_model_column.client == mock_client
        assert data_model_column.data_pool_id == example_data_model.pool_id
        assert data_model_column.data_model_id == example_data_model.id
        assert data_model_column.table_name == example_data_model_table.name
        assert data_model_column.table_alias == example_data_model_table.alias
        assert (
            data_model_column.dict(exclude={"data_pool_id", "data_model_id", "table_name", "table_alias"})
            == column.dict()
        )
