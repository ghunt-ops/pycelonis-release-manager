import pytest
from pycelonis.service.package_manager.service import ContentNodeTransport, SpaceTransport


@pytest.fixture(scope="function")
def example_content_node_transport():
    return ContentNodeTransport(
        **{
            "root": False,
            "asset": False,
            "root_with_key": "TEST_NODE.TEST_FOLDER",
            "base": None,
            "object_id": "aa4e3122-2708-494a-955f-3fcd105ee7cb",
            "identifier": "TEST_FOLDER",
            "tenant_id": None,
            "id": "aa4e3122-2708-494a-955f-3fcd105ee7cb",
            "key": "TEST_FOLDER",
            "name": "TEST_FOLDER",
            "root_node_key": "TEST_NODE",
            "asset_type": None,
            "node_type": "FOLDER",
            "parent_node_key": "TEST_NODE",
            "parent_node_id": None,
            "invalid_content": False,
            "serialized_content": None,
            "serialization_type": "YAML",
            "draft_id": "aa8937bf-0123-45d6-b565-783bfc6fa4d6",
            "working_draft_id": "aa8937bf-0123-45d6-b565-783bfc6fa4d6",
            "activated_draft_id": None,
            "show_in_viewer_mode": False,
            "public_available": False,
            "root_node_id": "ff98f938-3352-4602-9ec1-ef672616b941",
            "order": 0,
            "source": None,
            "asset_metadata_transport": None,
            "space_id": "aa728d7f-0609-4e31-a221-106eed97dd5f",
            "change_date": 1646647340308,
        }
    )


@pytest.fixture(scope="function")
def example_package_transport():
    return ContentNodeTransport(
        **{
            "root": True,
            "asset": False,
            "root_with_key": "NEW_NODE31.NEW_NODE31",
            "base": None,
            "object_id": "ff98f938-3352-4602-9ec1-ef672616b941",
            "identifier": "NEW_NODE31",
            "tenant_id": None,
            "id": "ff98f938-3352-4602-9ec1-ef672616b941",
            "key": "NEW_NODE31",
            "name": "NEW_NODE31",
            "root_node_key": "NEW_NODE31",
            "asset_type": None,
            "node_type": "PACKAGE",
            "parent_node_key": None,
            "parent_node_id": None,
            "invalid_content": False,
            "serialized_content": "variables: []\ndependencies: []\n",
            "serialization_type": "YAML",
            "draft_id": "8024ad7a-36d9-418e-9cbd-6ac2d6436ef9",
            "working_draft_id": "8024ad7a-36d9-418e-9cbd-6ac2d6436ef9",
            "activated_draft_id": None,
            "show_in_viewer_mode": False,
            "public_available": False,
            "root_node_id": "ff98f938-3352-4602-9ec1-ef672616b941",
            "order": 0,
            "source": None,
            "asset_metadata_transport": None,
            "space_id": "80728d7f-0609-4e31-a221-106eed97dd5f",
            "change_date": 1646647334165,
        }
    )


@pytest.fixture(scope="function")
def example_space_transport():
    return SpaceTransport(
        **{
            "creation_date": 1646145491584,
            "change_date": 1646145491584,
            "id": "63119a64-0b4b-4baf-a093-9596ecb5ad9b",
            "name": "TEST_SPACE",
            "icon_reference": "earth",
            "permissions": None,
            "object_id": None,
        }
    )


@pytest.fixture(scope="function")
def example_analysis_transport():
    return ContentNodeTransport(
        **{
            "root": False,
            "asset": True,
            "root_with_key": "PYTEST_PYCELONIS_PACKAGE_test_analysis_00000000.TEST_ANALYSIS",
            "base": None,
            "object_id": "2b3a2c9c-b831-4228-8468-87d27db3ec00",
            "identifier": "TEST_ANALYSIS",
            "tenant_id": None,
            "id": "2b3a2c9c-b831-4228-8468-87d27db3ec00",
            "key": "TEST_ANALYSIS",
            "name": "TEST_ANALYSIS",
            "root_node_key": "PYTEST_PYCELONIS_PACKAGE_test_analysis_00000000",
            "asset_type": "ANALYSIS",
            "node_type": "ASSET",
            "parent_node_key": "PYTEST_PYCELONIS_PACKAGE_test_analysis_00000000",
            "parent_node_id": None,
            "invalid_content": False,
            "serialized_content": '{"analysis":{"permissions":null,"id":"2b3a2c9c-b831-4228-8468-87d27db3ec00",'
            '"tenantId":null,"name":"TEST_ANALYSIS","key":null,"description":null,"deleted":false,"transportId":null,'
            '"lastPublishedDraftId":"2b3a2c9c-b831-4228-8468-87d27db3ec00","autoSaveId":null,"processId":null,'
            '"createDate":null,"favourite":false,"contentId":null,"contentVersion":0,"tags":null,"applicationId":"",'
            '"globalApp":false,"publicLink":false,"lastPublishedDate":null,"lastPublishedUser":null,'
            '"objectId":"2b3a2c9c-b831-4228-8468-87d27db3ec00","parentObjectId":null,"application":false,'
            '"publishedDraftId":"2b3a2c9c-b831-4228-8468-87d27db3ec00","folderId":'
            '"2b3a2c9c-b831-4228-8468-87d27db3ec00"},'
            '"kpis":[],"draft":{"id":"2b3a2c9c-b831-4228-8468-87d27db3ec00","title":null,"document":null,'
            '"lastChangeDate":'
            '"2022-04-07 09:35:05","lastChangeUserId":"DELETED","lastChangeUserName":'
            '"deleted-user@celonis.cloud(Deleted User)",'
            '"lockedUntilDate":"1970-01-01 00:00:00","sourceId":null},"dataModelId":null,"knowledgeModelKey":null,'
            '"nextDraftCreationDateTime":null}',
            "serialization_type": "JSON",
            "draft_id": "13a0926d-dfd9-44ac-a8aa-65ef4db78105",
            "working_draft_id": "13a0926d-dfd9-44ac-a8aa-65ef4db78105",
            "activated_draft_id": None,
            "show_in_viewer_mode": True,
            "public_available": False,
            "root_node_id": "ff98f938-3352-4602-9ec1-ef672616b941",
            "order": 0,
            "source": None,
            "asset_metadata_transport": {"used_variables": [], "related_assets": [], "metadata": None},
            "space_id": "c6bc1c33-3323-4e79-a717-16910f5e15a4",
            "change_date": 1649324105561,
        }
    )


@pytest.fixture(scope="function")
def example_folder_transport():
    return ContentNodeTransport(
        **{
            "root": False,
            "asset": False,
            "root_with_key": "TEST_NODE.TEST_FOLDER",
            "base": None,
            "object_id": "aa4e3122-2708-494a-955f-3fcd105ee7cb",
            "identifier": "TEST_FOLDER",
            "tenant_id": None,
            "id": "aa4e3122-2708-494a-955f-3fcd105ee7cb",
            "key": "TEST_FOLDER",
            "name": "TEST_FOLDER",
            "root_node_key": "TEST_NODE",
            "asset_type": None,
            "node_type": "FOLDER",
            "parent_node_key": "TEST_NODE",
            "parent_node_id": None,
            "invalid_content": False,
            "serialized_content": None,
            "serialization_type": "YAML",
            "draft_id": "aa8937bf-0123-45d6-b565-783bfc6fa4d6",
            "working_draft_id": "aa8937bf-0123-45d6-b565-783bfc6fa4d6",
            "activated_draft_id": None,
            "show_in_viewer_mode": False,
            "public_available": False,
            "root_node_id": "ff98f938-3352-4602-9ec1-ef672616b941",
            "order": 0,
            "source": None,
            "asset_metadata_transport": None,
            "space_id": "aa728d7f-0609-4e31-a221-106eed97dd5f",
            "change_date": 1646647340308,
        }
    )


@pytest.fixture(scope="function")
def example_view_transport():
    return ContentNodeTransport(
        **{
            "root": False,
            "asset": True,
            "root_with_key": "TEST_PACKAGE.test123",
            "base": None,
            "object_id": "0dcf0d51-7f17-46c0-a8a3-75a9cfa762bf",
            "identifier": "test123",
            "tenant_id": None,
            "id": "0dcf0d51-7f17-46c0-a8a3-75a9cfa762bf",
            "key": "test123",
            "name": "test123",
            "root_node_key": "TEST_PACKAGE",
            "asset_type": "BOARD",
            "node_type": "ASSET",
            "parent_node_key": "TEST_PACKAGE",
            "parent_node_id": None,
            "invalid_content": False,
            "serialized_content": 'metadata:\n  key: "test123"\n  template: false\n  name: "test123"\nlayout:\n'
            '  rows:\n  - id: "row_dc6bad99-a349-48b6-97d2-c74a7112b220"\n    columns:\n'
            '    - id: "column_7b587a66-9f0f-4f8c-a69e-f7bde9fe3ffc"\n      componentId: ""\n'
            '      size: "1"\n      type: "default"\n      order: 100\n    order: 100\ncomponents:\n'
            '- id: "table-8df2940c-1285-4a11-a395-1b0304627811"\n  type: "table"\n  settings:\n    data: {}\n'
            '- id: "kpi-list-45e92a0a-602b-4f23-a2a0-d40c4c937955"\n  type: "kpi-list"\n  settings:\n    data: {}\n'
            '- id: "table-e5dfde1d-2f32-4792-b4c1-ed368c813eef"\n  type: "table"\n  settings:\n    data: {}\n'
            "    options:\n      showPagination: false\n",
            "serialization_type": "YAML",
            "draft_id": "066982a1-0121-4016-9625-0c6f3927b869",
            "working_draft_id": "066982a1-0121-4016-9625-0c6f3927b869",
            "activated_draft_id": "07b510c4-9ee0-42f4-955f-a321129fa88e",
            "show_in_viewer_mode": True,
            "public_available": False,
            "root_node_id": "ff98f938-3352-4602-9ec1-ef672616b941",
            "order": 8,
            "source": None,
            "asset_metadata_transport": {
                "used_variables": [],
                "related_assets": [],
                "metadata": {"key": "test123", "name": "test123", "template": False},
            },
            "space_id": "3dffca7e-1d86-4ce8-b899-3397c78231a5",
            "change_date": 1651821950043,
        }
    )


@pytest.fixture(scope="function")
def example_simulation_transport():
    return ContentNodeTransport(
        **{
            "root": False,
            "asset": True,
            "root_with_key": "TEST_PACKAGE.eee",
            "base": None,
            "object_id": "779cea9b-edac-4ee0-ac03-dab5e825f02f",
            "identifier": "eee",
            "tenant_id": None,
            "id": "779cea9b-edac-4ee0-ac03-dab5e825f02f",
            "key": "eee",
            "name": "eee",
            "root_node_key": "TEST_PACKAGE",
            "asset_type": "simulation-asset",
            "node_type": "ASSET",
            "parent_node_key": "TEST_PACKAGE",
            "parent_node_id": None,
            "invalid_content": True,
            "serialized_content": '{"currentConfiguration":{"version":"v4",'
            '"path":"asset.knowledge_model.data_model_id"},"v4":{"model":{"extraction_settings":'
            '{"activity_table_name":"ACTIVITY_JOB","datamodel":"52819fdb-c2be-43a6-ba52-54e4c6664729"},'
            '"model_validation":'
            '{"data_check":false,"filter":false,"incoming_cases":false,"resource_assignment":false,"activity":false,'
            '"resource_details":false,"branch":false}},"asset":{"asset_version_id":0,"knowledge_model":'
            '{"id":"tttr","data_model_id":"52819fdb-c2be-43a6-ba52-54e4c6664729"},"activity_table":'
            '{"id":"ACTIVITY_JOB__ACTIVITY_EN","pql":"\\"ACTIVITY_JOB\\".\\"ACTIVITY_EN\\"","display_name":'
            '"Activity Job Activity En"}}}}',
            "serialization_type": "JSON",
            "draft_id": "2584715e-f1ff-416b-a21d-1f8ee07ea26d",
            "working_draft_id": "2584715e-f1ff-416b-a21d-1f8ee07ea26d",
            "activated_draft_id": None,
            "show_in_viewer_mode": True,
            "public_available": False,
            "root_node_id": "ff98f938-3352-4602-9ec1-ef672616b941",
            "order": 0,
            "source": None,
            "asset_metadata_transport": {"used_variables": [], "related_assets": [], "metadata": None},
            "space_id": "3dffca7e-1d86-4ce8-b899-3397c78231a5",
            "change_date": 1653314198267,
        }
    )
