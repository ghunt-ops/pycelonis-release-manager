import typing

import pytest
from pycelonis.ems.apps import PublishedSpace
from pycelonis.ems.apps.content_node import PublishedContentNode
from pycelonis.ems.apps.content_node.package import PublishedPackage


@pytest.fixture(scope="function")
def example_published_content_node(mock_client, example_content_node_transport):
    return PublishedContentNode.from_transport(mock_client, example_content_node_transport)


@pytest.fixture(scope="function")
def example_published_package(mock_client, example_package_transport):
    return PublishedPackage.from_transport(mock_client, example_package_transport)


@pytest.fixture(scope="function")
def example_published_space(mock_client, example_space_transport):
    return PublishedSpace.from_transport(mock_client, example_space_transport)


@pytest.fixture(scope="function")
def analysis_content() -> typing.Dict:
    return {
        "analysis": {
            "permissions": None,
            "id": "419d5eb3-2a81-4faf-91b2-0118866cd151",
            "tenantId": None,
            "name": "TEST_ANALYSIS",
            "key": None,
            "description": None,
            "deleted": False,
            "transportId": None,
            "lastPublishedDraftId": None,
            "autoSaveId": None,
            "processId": None,
            "createDate": None,
            "favourite": False,
            "contentId": None,
            "contentVersion": 0,
            "tags": None,
            "applicationId": "",
            "globalApp": False,
            "publicLink": False,
            "lastPublishedDate": None,
            "lastPublishedUser": None,
            "objectId": "419d5eb3-2a81-4faf-91b2-0118866cd151",
            "publishedDraftId": None,
            "application": False,
            "parentObjectId": None,
            "folderId": "419d5eb3-2a81-4faf-91b2-0118866cd151",
        },
        "kpis": [],
        "draft": {
            "id": "419d5eb3-2a81-4faf-91b2-0118866cd151",
            "title": None,
            "document": {
                "components": [
                    {
                        "name": "New Sheet 1",
                        "components": [
                            {
                                "id": "d4a7ecc2-bc07-4493-8144-38d11ee22ab7",
                                "type": "pql-table",
                                "chartType": "table",
                                "tooltips": True,
                                "axis0Config": {
                                    "axisLabelStyle": {
                                        "fontColor": "",
                                        "backgroundColor": "",
                                        "borderColor": "",
                                        "fontSize": 11,
                                        "currentFontSize": {"name": "x-small 11px", "value": 11},
                                    },
                                    "axisLineStyle": {"lineOpacity": 1},
                                    "axisTitleStyle": {
                                        "fontColor": "",
                                        "backgroundColor": "",
                                        "borderColor": "",
                                        "fontSize": 13,
                                        "currentFontSize": {"name": "small 13px", "value": 13},
                                    },
                                    "gridlineStyle": {"lineOpacity": 1},
                                    "showAxis": True,
                                    "showAxisLabels": True,
                                    "showTickLines": True,
                                    "autoTickCount": True,
                                    "gapWidth": 0.45,
                                },
                                "axis1Config": {
                                    "axisLabelStyle": {
                                        "fontColor": "",
                                        "backgroundColor": "",
                                        "borderColor": "",
                                        "fontSize": 11,
                                        "currentFontSize": {"name": "x-small 11px", "value": 11},
                                    },
                                    "axisLineStyle": {"lineOpacity": 1},
                                    "axisTitleStyle": {
                                        "fontColor": "",
                                        "backgroundColor": "",
                                        "borderColor": "",
                                        "fontSize": 13,
                                        "currentFontSize": {"name": "small 13px", "value": 13},
                                    },
                                    "gridlineStyle": {"lineOpacity": 1, "lineWidth": 1, "lineColor": "#e4e4e4"},
                                    "showGridlines": True,
                                    "showAxis": True,
                                    "showAxisLabels": True,
                                    "boundsMode": "AUTO",
                                    "showTickLines": True,
                                    "autoTickCount": True,
                                },
                                "axis2Config": {
                                    "axisLabelStyle": {"fontColor": "", "backgroundColor": "", "borderColor": ""},
                                    "axisLineStyle": {},
                                    "axisTitleStyle": {
                                        "fontColor": "",
                                        "backgroundColor": "",
                                        "borderColor": "",
                                        "fontSize": 13,
                                        "currentFontSize": {"name": "small 13px", "value": 13},
                                    },
                                    "gridlineStyle": {},
                                    "showAxis": True,
                                    "showAxisLabels": True,
                                    "boundsMode": "AUTO",
                                    "showTickLines": True,
                                    "autoTickCount": True,
                                },
                                "axis0": [
                                    {
                                        "text": '"BIG_ACTIVITY_TABLE"."ACTIVITY"',
                                        "name": "#{BIG_ACTIVITY_TABLE.ACTIVITY}",
                                        "valueFormat": "",
                                        "type": "dimension",
                                    },
                                    {
                                        "text": '"BIG_ACTIVITY_TABLE"."KEY"',
                                        "name": "#{BIG_ACTIVITY_TABLE.KEY}",
                                        "valueFormat": "",
                                        "type": "dimension",
                                    },
                                ],
                                "axis1": [],
                                "axis2": [],
                                "width": 85,
                                "height": 19,
                                "legendShow": True,
                                "showTitle": True,
                                "legendPosition": "bc",
                                "legendOverlay": False,
                                "legendFontStyle": {
                                    "backgroundColor": "",
                                    "borderColor": "",
                                    "fontColor": "",
                                    "fontSize": 11,
                                    "currentFontSize": {"name": "x-small 11px", "value": 11},
                                },
                                "dataLabelsPositions": [
                                    {"value": "top", "name": "top"},
                                    {"value": "middle", "name": "middle"},
                                    {"value": "bottom", "name": "bottom"},
                                    {"value": "custom", "name": "custom"},
                                ],
                                "textStyle": {"currentFontSize": {"name": "medium 14px", "value": 14}, "fontSize": 14},
                                "limitMode": "NO_LIMIT",
                                "limitNumber": 100,
                                "maximized": False,
                                "title": "",
                                "selection": [],
                                "border": False,
                                "toolBorder": False,
                                "showHeader": True,
                                "backgroundColor": "#ffffff",
                                "filteringSelf": True,
                                "componentFilter": "",
                                "clickToFilter": True,
                                "hasBackground": True,
                                "contextMenuMethods": {
                                    "settings": True,
                                    "componentFilter": True,
                                    "export": True,
                                    "layers": True,
                                    "fullscreen": True,
                                    "copy": True,
                                    "deletable": True,
                                },
                                "hasHoverbuttons": False,
                                "feedbackMode": False,
                                "diagramBackground": False,
                                "vertical": False,
                                "titleStyle": {
                                    "currentFontSize": {"name": "x-large 17px", "value": 17},
                                    "fontSize": 17,
                                },
                                "diagramBackgroundStyle": {"fillColor": "", "opacity": 1},
                                "diagramBorder": True,
                                "diagramBorderStyle": {"lineColor": "#e9e9e9", "lineOpacity": 1, "lineWidth": 1},
                                "allowDataLink": False,
                                "x": 2,
                                "y": 1,
                                "zIndex": 1,
                                "showOthers": False,
                                "hoverButtonFixed": False,
                                "hoverButtonPosition": "RIGHT",
                            },
                            {
                                "id": "760f6794-2d0a-4933-9699-c4ae932d4420",
                                "type": "pql-table",
                                "chartType": "pie",
                                "tooltips": True,
                                "axis0Config": {
                                    "axisLabelStyle": {
                                        "fontColor": "",
                                        "backgroundColor": "",
                                        "borderColor": "",
                                        "fontSize": 11,
                                        "currentFontSize": {"name": "x-small 11px", "value": 11},
                                    },
                                    "axisLineStyle": {"lineOpacity": 1},
                                    "axisTitleStyle": {
                                        "fontColor": "",
                                        "backgroundColor": "",
                                        "borderColor": "",
                                        "fontSize": 13,
                                        "currentFontSize": {"name": "small 13px", "value": 13},
                                    },
                                    "gridlineStyle": {"lineOpacity": 1},
                                    "showAxis": True,
                                    "showAxisLabels": True,
                                    "showTickLines": True,
                                    "autoTickCount": True,
                                    "gapWidth": 0.45,
                                },
                                "axis1Config": {
                                    "axisLabelStyle": {
                                        "fontColor": "",
                                        "backgroundColor": "",
                                        "borderColor": "",
                                        "fontSize": 11,
                                        "currentFontSize": {"name": "x-small 11px", "value": 11},
                                    },
                                    "axisLineStyle": {"lineOpacity": 1},
                                    "axisTitleStyle": {
                                        "fontColor": "",
                                        "backgroundColor": "",
                                        "borderColor": "",
                                        "fontSize": 13,
                                        "currentFontSize": {"name": "small 13px", "value": 13},
                                    },
                                    "gridlineStyle": {"lineOpacity": 1, "lineWidth": 1, "lineColor": "#e4e4e4"},
                                    "showGridlines": True,
                                    "showAxis": True,
                                    "showAxisLabels": True,
                                    "boundsMode": "AUTO",
                                    "showTickLines": True,
                                    "autoTickCount": True,
                                },
                                "axis2Config": {
                                    "axisLabelStyle": {"fontColor": "", "backgroundColor": "", "borderColor": ""},
                                    "axisLineStyle": {},
                                    "axisTitleStyle": {
                                        "fontColor": "",
                                        "backgroundColor": "",
                                        "borderColor": "",
                                        "fontSize": 13,
                                        "currentFontSize": {"name": "small 13px", "value": 13},
                                    },
                                    "gridlineStyle": {},
                                    "showAxis": True,
                                    "showAxisLabels": True,
                                    "boundsMode": "AUTO",
                                    "showTickLines": True,
                                    "autoTickCount": True,
                                },
                                "axis0": [
                                    {
                                        "text": '"BIG_ACTIVITY_TABLE"."ACTIVITY"',
                                        "name": "#{BIG_ACTIVITY_TABLE.ACTIVITY}",
                                        "valueFormat": "",
                                        "type": "dimension",
                                        "meta": {
                                            "columnName": "#{BIG_ACTIVITY_TABLE.ACTIVITY}",
                                            "columnType": "string",
                                            "expressionLhs": '"BIG_ACTIVITY_TABLE"."ACTIVITY" AS '
                                            '"#{BIG_ACTIVITY_TABLE.ACTIVITY}"',
                                            "format": "",
                                        },
                                    }
                                ],
                                "axis1": [],
                                "axis2": [
                                    {
                                        "name": "#{Count}(#{BIG_ACTIVITY_TABLE.ACTIVITY})",
                                        "text": 'COUNT("BIG_ACTIVITY_TABLE"."ACTIVITY")',
                                        "valueFormat": "",
                                        "function": {
                                            "name": "Count",
                                            "displayName": "Count",
                                            "STRING": True,
                                            "INTEGER": True,
                                            "FLOAT": True,
                                            "DATE": True,
                                        },
                                        "ignoreSeriesPalettes": False,
                                        "dataLabelStyle": {"font": "Proxima Nova", "fontSize": 12},
                                        "fillStyle": {"opacity": 1},
                                        "showDataLabels": False,
                                        "dataLabelsPosition": "custom",
                                        "textColor": "",
                                        "textColorMapping": "",
                                        "seriesColor": "",
                                        "seriesPalette": "",
                                        "seriesColorMapping": "",
                                        "meta": {
                                            "columnName": "#{Count}(#{BIG_ACTIVITY_TABLE.ACTIVITY})",
                                            "columnType": "int",
                                            "expressionLhs": None,
                                            "format": "",
                                        },
                                    }
                                ],
                                "width": 30,
                                "height": 10,
                                "legendShow": True,
                                "showTitle": True,
                                "legendPosition": "bc",
                                "legendOverlay": False,
                                "legendFontStyle": {
                                    "backgroundColor": "",
                                    "borderColor": "",
                                    "fontColor": "",
                                    "fontSize": 11,
                                    "currentFontSize": {"name": "x-small 11px", "value": 11},
                                },
                                "dataLabelsPositions": [
                                    {"value": "top", "name": "top"},
                                    {"value": "middle", "name": "middle"},
                                    {"value": "bottom", "name": "bottom"},
                                    {"value": "custom", "name": "custom"},
                                ],
                                "textStyle": {"currentFontSize": {"name": "medium 14px", "value": 14}, "fontSize": 14},
                                "limitMode": "TOP_K",
                                "limitNumber": 4,
                                "maximized": False,
                                "title": "",
                                "selection": [],
                                "border": False,
                                "toolBorder": False,
                                "showHeader": True,
                                "backgroundColor": "#ffffff",
                                "filteringSelf": True,
                                "componentFilter": "",
                                "clickToFilter": True,
                                "hasBackground": True,
                                "contextMenuMethods": {
                                    "settings": True,
                                    "componentFilter": True,
                                    "export": True,
                                    "layers": True,
                                    "fullscreen": True,
                                    "copy": True,
                                    "deletable": True,
                                },
                                "hasHoverbuttons": False,
                                "feedbackMode": False,
                                "diagramBackground": False,
                                "vertical": False,
                                "titleStyle": {
                                    "currentFontSize": {"name": "x-large 17px", "value": 17},
                                    "fontSize": 17,
                                },
                                "diagramBackgroundStyle": {"fillColor": "", "opacity": 1},
                                "diagramBorder": True,
                                "diagramBorderStyle": {"lineColor": "#e9e9e9", "lineOpacity": 1, "lineWidth": 1},
                                "allowDataLink": False,
                                "x": 21,
                                "y": 25,
                                "zIndex": 1,
                                "showOthers": False,
                            },
                            {
                                "id": "c70941f2-ad25-48ef-8d24-493a72331ace",
                                "type": "single-kpi",
                                "viewType": "number",
                                "initThresholdsCount": 1,
                                "width": 20,
                                "height": 10,
                                "minWidth": 2,
                                "minHeight": 2,
                                "maximized": False,
                                "title": "",
                                "selection": [],
                                "border": False,
                                "toolBorder": False,
                                "showHeader": True,
                                "backgroundColor": "#ffffff",
                                "filteringSelf": True,
                                "componentFilter": "",
                                "clickToFilter": True,
                                "hasBackground": True,
                                "contextMenuMethods": {
                                    "settings": True,
                                    "componentFilter": True,
                                    "export": True,
                                    "layers": True,
                                    "fullscreen": True,
                                    "copy": True,
                                    "deletable": True,
                                },
                                "hasHoverbuttons": False,
                                "feedbackMode": False,
                                "diagramBackground": False,
                                "vertical": False,
                                "titleStyle": {
                                    "currentFontSize": {"name": "x-large 17px", "value": 17},
                                    "fontSize": 17,
                                },
                                "diagramBackgroundStyle": {"fillColor": "", "opacity": 1},
                                "diagramBorder": True,
                                "diagramBorderStyle": {"lineColor": "#e9e9e9", "lineOpacity": 1, "lineWidth": 1},
                                "allowDataLink": False,
                                "x": 53,
                                "y": 32,
                                "zIndex": 1,
                                "settings": {
                                    "viewType": "number",
                                    "fixedTextSize": False,
                                    "subtitlePosition": "left",
                                    "initThresholdsCount": 1,
                                    "singleColorEnabled": True,
                                    "singleColor": "#1f77b4",
                                },
                                "filteredThresholds": False,
                                "formula": {
                                    "text": 'COUNT("BIG_ACTIVITY_TABLE"."ACTIVITY")',
                                    "name": "Single KPI",
                                    "valueFormat": "",
                                    "translatedName": "Single KPI",
                                },
                                "version": 1,
                                "thresholds": [{"formula": {"text": "1500"}, "color": "#1f77b4", "value": 1500}],
                                "segmentsInput": [
                                    {"formula": {"text": "1500"}, "color": "#1f77b4"},
                                    {"formula": {"text": "1500"}, "color": "#1f77b4"},
                                ],
                                "kpiValue": 1000000,
                            },
                        ],
                        "position": {"top": 0, "left": 0, "height": 800, "width": 1200},
                        "id": "a1243fc4-2755-4cc0-bafd-62afde608196",
                        "contentType": "blank-sheet",
                        "format": "FULLSCREEN",
                        "sheetFilter": {"text": ""},
                    },
                    {
                        "name": "New Sheet 2",
                        "components": [
                            {
                                "id": "255d1f78-ae76-4b2c-b25c-fb5a660b9f42",
                                "type": "pql-table",
                                "chartType": "table",
                                "tooltips": True,
                                "axis0Config": {
                                    "axisLabelStyle": {
                                        "fontColor": "",
                                        "backgroundColor": "",
                                        "borderColor": "",
                                        "fontSize": 11,
                                        "currentFontSize": {"name": "x-small 11px", "value": 11},
                                    },
                                    "axisLineStyle": {"lineOpacity": 1},
                                    "axisTitleStyle": {
                                        "fontColor": "",
                                        "backgroundColor": "",
                                        "borderColor": "",
                                        "fontSize": 13,
                                        "currentFontSize": {"name": "small 13px", "value": 13},
                                    },
                                    "gridlineStyle": {"lineOpacity": 1},
                                    "showAxis": True,
                                    "showAxisLabels": True,
                                    "showTickLines": True,
                                    "autoTickCount": True,
                                    "gapWidth": 0.45,
                                },
                                "axis1Config": {
                                    "axisLabelStyle": {
                                        "fontColor": "",
                                        "backgroundColor": "",
                                        "borderColor": "",
                                        "fontSize": 11,
                                        "currentFontSize": {"name": "x-small 11px", "value": 11},
                                    },
                                    "axisLineStyle": {"lineOpacity": 1},
                                    "axisTitleStyle": {
                                        "fontColor": "",
                                        "backgroundColor": "",
                                        "borderColor": "",
                                        "fontSize": 13,
                                        "currentFontSize": {"name": "small 13px", "value": 13},
                                    },
                                    "gridlineStyle": {"lineOpacity": 1, "lineWidth": 1, "lineColor": "#e4e4e4"},
                                    "showGridlines": True,
                                    "showAxis": True,
                                    "showAxisLabels": True,
                                    "boundsMode": "AUTO",
                                    "showTickLines": True,
                                    "autoTickCount": True,
                                },
                                "axis2Config": {
                                    "axisLabelStyle": {"fontColor": "", "backgroundColor": "", "borderColor": ""},
                                    "axisLineStyle": {},
                                    "axisTitleStyle": {
                                        "fontColor": "",
                                        "backgroundColor": "",
                                        "borderColor": "",
                                        "fontSize": 13,
                                        "currentFontSize": {"name": "small 13px", "value": 13},
                                    },
                                    "gridlineStyle": {},
                                    "showAxis": True,
                                    "showAxisLabels": True,
                                    "boundsMode": "AUTO",
                                    "showTickLines": True,
                                    "autoTickCount": True,
                                },
                                "axis0": [
                                    {
                                        "text": '"BIG_ACTIVITY_TABLE"."ACTIVITY"',
                                        "name": "#{BIG_ACTIVITY_TABLE.ACTIVITY}",
                                        "valueFormat": "",
                                        "type": "dimension",
                                    },
                                    {
                                        "text": '"BIG_ACTIVITY_TABLE"."KEY"',
                                        "name": "#{BIG_ACTIVITY_TABLE.KEY}",
                                        "valueFormat": "",
                                        "type": "dimension",
                                    },
                                ],
                                "axis1": [],
                                "axis2": [],
                                "width": 60,
                                "height": 20,
                                "legendShow": True,
                                "showTitle": True,
                                "legendPosition": "bc",
                                "legendOverlay": False,
                                "legendFontStyle": {
                                    "backgroundColor": "",
                                    "borderColor": "",
                                    "fontColor": "",
                                    "fontSize": 11,
                                    "currentFontSize": {"name": "x-small 11px", "value": 11},
                                },
                                "dataLabelsPositions": [
                                    {"value": "top", "name": "top"},
                                    {"value": "middle", "name": "middle"},
                                    {"value": "bottom", "name": "bottom"},
                                    {"value": "custom", "name": "custom"},
                                ],
                                "textStyle": {"currentFontSize": {"name": "medium 14px", "value": 14}, "fontSize": 14},
                                "limitMode": "NO_LIMIT",
                                "limitNumber": 100,
                                "maximized": False,
                                "title": "",
                                "selection": [],
                                "border": False,
                                "toolBorder": False,
                                "showHeader": True,
                                "backgroundColor": "#ffffff",
                                "filteringSelf": True,
                                "componentFilter": "",
                                "clickToFilter": True,
                                "hasBackground": True,
                                "contextMenuMethods": {
                                    "settings": True,
                                    "componentFilter": True,
                                    "export": True,
                                    "layers": True,
                                    "fullscreen": True,
                                    "copy": True,
                                    "deletable": True,
                                },
                                "hasHoverbuttons": False,
                                "feedbackMode": False,
                                "diagramBackground": False,
                                "vertical": False,
                                "titleStyle": {
                                    "currentFontSize": {"name": "x-large 17px", "value": 17},
                                    "fontSize": 17,
                                },
                                "diagramBackgroundStyle": {"fillColor": "", "opacity": 1},
                                "diagramBorder": True,
                                "diagramBorderStyle": {"lineColor": "#e9e9e9", "lineOpacity": 1, "lineWidth": 1},
                                "allowDataLink": False,
                                "x": 6,
                                "y": 4,
                                "zIndex": 1,
                                "showOthers": False,
                                "hoverButtonFixed": False,
                                "hoverButtonPosition": "RIGHT",
                            }
                        ],
                        "position": {"top": 0, "left": 0, "height": 800, "width": 1200},
                        "id": "b667b665-951e-4fb3-9212-3085c79f14c0",
                        "contentType": "blank-sheet",
                        "format": "FULLSCREEN",
                        "sheetFilter": {"text": ""},
                    },
                ],
                "theme": "celonis_current",
                "editMode": True,
                "id": "419d5eb3-2a81-4faf-91b2-0118866cd151",
                "name": "TEST_ANALYSIS",
                "translationMap": {},
                "KPILibrary": [],
                "colorMappings": [],
                "palettes": [],
            },
            "lastChangeDate": "2022-05-11 09:16:39",
            "lastChangeUserId": "7bc8c1c6-1a0e-43cc-a903-1da1aafaf775",
            "lastChangeUserName": "user",
            "lockedUntilDate": None,
            "sourceId": "4e14d97f-66a6-4496-88b6-534e93a76b1c",
        },
        "dataModelId": "d24d5eb4-37be-4bd6-b42f-5ee7aaee1b24",
        "knowledgeModelKey": None,
        "nextDraftCreationDateTime": "2022-05-11 09:45:41",
    }
