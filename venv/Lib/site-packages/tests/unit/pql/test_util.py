from unittest.mock import Mock

from pycelonis.ems.data_integration.data_model_table_column import DataModelTableColumn
from pycelonis.pql.util import convert_column_to_pql_string
from pycelonis_core.client.client import Client


class TestConvertColumnToPQLString:
    def test_convert_column_to_pql_string_no_alias(self):
        column = DataModelTableColumn(
            client=Mock(Client),
            table_name="TEST_TABLE",
            name="TEST_COLUMN",
            data_model_id="DM_ID",
            data_pool_id="DP_ID",
        )

        assert convert_column_to_pql_string(column) == '"TEST_TABLE"."TEST_COLUMN"'

    def test_convert_column_to_pql_string_with_alias(self):
        column = DataModelTableColumn(
            client=Mock(Client),
            table_name="TEST_TABLE",
            table_alias="TEST_ALIAS",
            name="TEST_COLUMN",
            data_model_id="DM_ID",
            data_pool_id="DP_ID",
        )

        assert convert_column_to_pql_string(column) == '"TEST_ALIAS"."TEST_COLUMN"'
