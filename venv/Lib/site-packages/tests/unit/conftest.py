from unittest.mock import Mock

import pandas as pd
import pytest
from pycelonis_core.client.client import Client


@pytest.fixture
def mock_client():
    return Mock(Client)


def assert_series_equals(series1: pd.Series, series2: pd.Series, **kwargs) -> None:
    """Assert call to check if two series are identical.

    Args:
        series1: First pandas series.
        series2: Second pandas series.
    """
    sorted_series1 = series1.sort_values(ascending=True).reset_index(drop=True)
    sorted_series2 = series2.sort_values(ascending=True).reset_index(drop=True)
    pd.testing.assert_series_equal(sorted_series1, sorted_series2, **kwargs)


def assert_frame_equals(df1: pd.DataFrame, df2: pd.DataFrame, **kwargs) -> None:
    """Assert call to check if two data frames are identical.

    Args:
        df1: First data frame.
        df2: second data frame.
    """
    sorted_df1 = df1.sort_values(by=list(df1.columns), ascending=True).reset_index(drop=True)
    sorted_df2 = df2.sort_values(by=list(df2.columns), ascending=True).reset_index(drop=True)
    pd.testing.assert_frame_equal(sorted_df1, sorted_df2, **kwargs)
