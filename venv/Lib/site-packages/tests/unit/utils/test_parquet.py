import io
from unittest.mock import Mock, patch

import pandas as pd
from pycelonis.utils.parquet import read_parquet, write_parquet


class TestParquet:
    @patch("pandas.read_parquet")
    def test_read_parquet(self, mock_read_parquet):
        FILE = io.BytesIO()

        read_parquet(FILE)

        mock_read_parquet.assert_called_once_with(
            FILE,
            engine="pyarrow",
        )

    def test_write_parquet(self):
        FILE = io.BytesIO()
        DF = pd.DataFrame({"TEST": [1, 2, 3]})
        DF.to_parquet = Mock()

        write_parquet(DF, FILE)

        DF.to_parquet.assert_called_once_with(
            FILE,
            engine="pyarrow",
            use_deprecated_int96_timestamps=True,
            index=False,
        )
